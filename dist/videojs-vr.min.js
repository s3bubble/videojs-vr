/*! @name videojs-vr @version 1.10.0 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document"),require("video.js")):"function"==typeof define&&define.amd?define(["global/window","global/document","video.js"],t):(e=e||self).videojsVr=t(e.window,e.document,e.videojs)}(this,(function(e,t,n){"use strict";function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;var s=i(r((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports}))),o=r((function(e){function t(n,i){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}));i(o);var a=i(r((function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports})));var l="ready",h="presenting",c="presenting-fullscreen",u="preparing",d="error-no-presentable-displays",p="error-browser-not-supported",f="error-request-to-present-rejected",m="error-exit-present-rejected",v="error-request-state-change-rejected",g="error-unkown",y=r((function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e,t){var i=n?n+e:e,r=this._events[i];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var s=0,o=r.length,a=new Array(o);s<o;s++)a[s]=r[s].fn;return a},s.prototype.emit=function(e,t,i,r,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var l,h,c=this._events[a],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,r),!0;case 5:return c.fn.call(c.context,t,i,r,s),!0;case 6:return c.fn.call(c.context,t,i,r,s,o),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else{var d,p=c.length;for(h=0;h<p;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,i);break;case 4:c[h].fn.call(c[h].context,t,i,r);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c[h].fn.apply(c[h].context,l)}}return!0},s.prototype.on=function(e,t,i){var s=new r(t,i||this),o=n?n+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],s]:this._events[o].push(s):(this._events[o]=s,this._eventsCount++),this},s.prototype.once=function(e,t,i){var s=new r(t,i||this,!0),o=n?n+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],s]:this._events[o].push(s):(this._events[o]=s,this._eventsCount++),this},s.prototype.removeListener=function(e,t,r,s){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return 0==--this._eventsCount?this._events=new i:delete this._events[o],this;var a=this._events[o];if(a.fn)a.fn!==t||s&&!a.once||r&&a.context!==r||(0==--this._eventsCount?this._events=new i:delete this._events[o]);else{for(var l=0,h=[],c=a.length;l<c;l++)(a[l].fn!==t||s&&!a[l].once||r&&a[l].context!==r)&&h.push(a[l]);h.length?this._events[o]=1===h.length?h[0]:h:0==--this._eventsCount?this._events=new i:delete this._events[o]}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prototype.setMaxListeners=function(){return this},s.prefixed=n,s.EventEmitter=s,e.exports=s})),_=r((function(e){
/*!
	* screenfull
	* v3.3.3 - 2018-09-04
	* (c) Sindre Sorhus; MIT License
	*/
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=n.length,s={};i<r;i++)if((e=n[i])&&e[1]in t){for(i=0;i<e.length;i++)s[n[0][i]]=e[i];return s}return!1}(),s={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(e){var n=r.requestFullscreen;e=e||t.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[n]():e[n](i?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){t[r.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var i=s[e];i&&t.addEventListener(i,n,!1)},off:function(e,n){var i=s[e];i&&t.removeEventListener(i,n,!1)},raw:r};r?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=o:window.screenfull=o):n?e.exports=!1:window.screenfull=!1}()}));class b extends y{constructor(){super(),this.state=u,this.__onVRDisplayPresentChange=this.__onVRDisplayPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.__onVRDisplayPresentChange),this.__onChangeFullscreen=this.__onChangeFullscreen.bind(this),_.enabled&&document.addEventListener(_.raw.fullscreenchange,this.__onChangeFullscreen)}checkDisplays(){return b.getVRDisplay().then(e=>(this.defaultDisplay=e,this.__setState(l),e)).catch(e=>{delete this.defaultDisplay,"NO_DISPLAYS"==e.name?this.__setState(d):"WEBVR_UNSUPPORTED"==e.name?this.__setState(p):this.__setState(g)})}remove(){window.removeEventListener("vrdisplaypresentchange",this.__onVRDisplayPresentChange),_.enabled&&document.removeEventListener(_.raw.fullscreenchanged,this.__onChangeFullscreen),this.removeAllListeners()}static getVRDisplay(){return new Promise((e,t)=>{if(!navigator||!navigator.getVRDisplays){let e=new Error("Browser not supporting WebVR");return e.name="WEBVR_UNSUPPORTED",void t(e)}const n=()=>{let e=new Error("No displays found");e.name="NO_DISPLAYS",t(e)};navigator.getVRDisplays().then((function(t){for(let n=0;n<t.length;n++)if(t[n].capabilities.canPresent){e(t[n]);break}n()}),n)})}enterVR(e,t){return this.presentedSource=t,e.requestPresent([{source:t}]).then(()=>{},()=>this.__setState(f))}exitVR(e){return e.exitPresent().then(()=>{this.presentedSource=void 0},()=>this.__setState(m))}enterFullscreen(e){return _.enabled?_.request(e):this.__setState(c),!0}exitFullscreen(){return _.enabled&&_.isFullscreen?_.exit():this.state==c&&this.checkDisplays(),!0}__setState(e){e!=this.state&&(this.emit("change",e,this.state),this.state=e)}__onChangeFullscreen(e){_.isFullscreen?this.state!=h&&this.__setState(c):this.checkDisplays()}__onVRDisplayPresentChange(e){try{let t;if(e.display?t=e.display:e.detail&&e.detail.display&&(t=e.detail.display),t&&t.isPresenting&&t.getLayers()[0].source!==this.presentedSource)return;const n=this.defaultDisplay&&this.defaultDisplay.isPresenting;this.__setState(n?h:l)}catch(e){}}}let E={};const x=e=>{const t=e.height/3;e.injectCSS&&(E[e.cssprefix]||((e=>{const t=document.createElement("style");t.innerHTML=e;let n=document.getElementsByTagName("head")[0];n.insertBefore(t,n.firstChild)})(C(e,t)),E[e.cssprefix]=!0));const n=document.createElement("div");return n.innerHTML=((e,t)=>{const n=.8*t;return`<button class="${e}-button">\n          <div class="${e}-title"></div>\n          <div class="${e}-logo" >${w(e,n)+R(e,n)}</div>\n        </button>`})(e.cssprefix,t),n.firstChild},w=(e,t)=>`<svg class="${e}-svg" version="1.1" x="0px" y="0px" \n        width="${28/18*t}px" height="${t}px" viewBox="0 0 28 18" xml:space="preserve">\n        <path d="M26.8,1.1C26.1,0.4,25.1,0,24.2,0H3.4c-1,0-1.7,0.4-2.4,1.1C0.3,1.7,0,2.7,0,3.6v10.7\n        c0,1,0.3,1.9,0.9,2.6C1.6,17.6,2.4,18,3.4,18h5c0.7,0,1.3-0.2,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l\n        1.5-2.6C13.2,13.1,13,13,14,13v0h-0.2 h0c0.3,0,0.7,0.1,0.8,0.5l1.4,2.6c0.3,0.6,0.8,1.1,1.3,\n        1.4c0.6,0.3,1.2,0.5,1.8,0.5h5c1,0,2-0.4,2.7-1.1c0.7-0.7,1.2-1.6,1.2-2.6 V3.6C28,2.7,27.5,\n        1.7,26.8,1.1z M7.4,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8c1.6,0,2.8,1.3,2.8,2.8\n        C10.2,10.5,8.9,11.8,7.4,11.8z M20.1,11.8c-1.6,0-2.8-1.3-2.8-2.8c0-1.6,1.3-2.8,2.8-2.8C21.7\n        ,6.2,23,7.4,23,9 C23,10.5,21.7,11.8,20.1,11.8z"/>\n    </svg>`,R=(e,t)=>`<svg class="${e}-svg-error" x="0px" y="0px" \n        width="${28/18*t}px" height="${28/18*t}px" viewBox="0 0 28 28" xml:space="preserve">\n        <path d="M17.6,13.4c0-0.2-0.1-0.4-0.1-0.6c0-1.6,1.3-2.8,2.8-2.8s2.8,1.3,2.8,2.8s-1.3,2.8-2.8,2.8\n        c-0.2,0-0.4,0-0.6-0.1l5.9,5.9c0.5-0.2,0.9-0.4,1.3-0.8\n        c0.7-0.7,1.1-1.6,1.1-2.5V7.4c0-1-0.4-1.9-1.1-2.5c-0.7-0.7-1.6-1-2.5-1\n        H8.1 L17.6,13.4z"/>\n        <path d="M10.1,14.2c-0.5,0.9-1.4,1.4-2.4,1.4c-1.6,0-2.8-1.3-2.8-2.8c0-1.1,0.6-2,1.4-2.5\n        L0.9,5.1 C0.3,5.7,0,6.6,0,7.5v10.7c0,1,0.4,1.8,1.1,2.5c0.7,0.7,1.6,1,2.5,1\n        h5c0.7,0,1.3-0.1,1.8-0.5c0.6-0.3,1-0.8,1.3-1.4l1.3-2.6 L10.1,14.2z"/>\n        <path d="M25.5,27.5l-25-25C-0.1,2-0.1,1,0.5,0.4l0,0C1-0.1,2-0.1,2.6,0.4l25,25c0.6,0.6,0.6,1.5\n        ,0,2.1l0,0 C27,28.1,26,28.1,25.5,27.5z"/>\n    </svg>`,C=(e,t=18)=>{const n=e.height,i=e.background?e.background:e.color,r=e.cssprefix;let s;return s="round"==e.corners?e.height/2:"square"==e.corners?2:e.corners,`\n    @font-face {\n        font-family: 'Karla';\n        font-style: normal;\n        font-weight: 400;\n        src: local('Karla'), local('Karla-Regular'), \n             url(https://fonts.gstatic.com/s/karla/v5/31P4mP32i98D9CEnGyeX9Q.woff2) format('woff2');\n        unicode-range: U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;\n    }\n    @font-face {\n        font-family: 'Karla';\n        font-style: normal;\n        font-weight: 400;\n        src: local('Karla'), local('Karla-Regular'), \n             url(https://fonts.gstatic.com/s/karla/v5/Zi_e6rBgGqv33BWF8WTq8g.woff2) format('woff2');\n        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, \n                       U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;\n    }\n\n    button.${r}-button {\n        font-family: 'Karla', sans-serif;\n\n        border: ${i} 2px solid;\n        border-radius: ${s}px;\n        box-sizing: border-box;\n        background: ${e.background?e.background:"none"};\n\n        height: ${n}px;\n        min-width: ${9.6*t}px;\n        display: inline-block;\n        position: relative;\n\n        cursor: pointer;\n    }\n    \n    button.${r}-button:focus {\n      outline: none;\n    }\n\n    /*\n    * Logo\n    */\n\n    .${r}-logo {\n        width: ${n}px;\n        height: ${n}px;\n        position: absolute;\n        top:0px;\n        left:0px;\n        width: ${n-4}px;\n        height: ${n-4}px;\n    }\n    .${r}-svg {\n        fill: ${e.color};\n        margin-top: ${(n-.8*t)/2-2}px;\n        margin-left: ${n/3}px;\n    }\n    .${r}-svg-error {\n        fill: ${e.color};\n        display:none;\n        margin-top: ${(n-28/18*t*.8)/2-2}px;\n        margin-left: ${n/3}px;\n    }\n\n\n    /*\n    * Title\n    */\n\n    .${r}-title {\n        color: ${e.color};\n        position: relative;\n        font-size: ${t}px;\n        padding-left: ${1.05*n}px;\n        padding-right: ${s-10<5?n/3:s-10}px;\n    }\n\n    /*\n    * disabled\n    */\n\n    button.${r}-button[disabled=true] {\n        opacity: ${e.disabledOpacity};\n        cursor: default;\n    }\n\n    button.${r}-button[disabled=true] > .${r}-logo > .${r}-svg {\n        display:none;\n    }\n\n    button.${r}-button[disabled=true] > .${r}-logo > .${r}-svg-error {\n        display:initial;\n    }\n  `};class T extends y{constructor(e,t){super(),(t=t||{}).color=t.color||"rgb(80,168,252)",t.background=t.background||!1,t.disabledOpacity=t.disabledOpacity||.5,t.height=t.height||55,t.corners=t.corners||"square",t.cssprefix=t.cssprefix||"webvr-ui",t.textEnterVRTitle=t.textEnterVRTitle||"ENTER VR",t.textVRNotFoundTitle=t.textVRNotFoundTitle||"VR NOT FOUND",t.textExitVRTitle=t.textExitVRTitle||"EXIT VR",t.onRequestStateChange=t.onRequestStateChange||(()=>!0),t.beforeEnter=t.beforeEnter||void 0,t.beforeExit=t.beforeExit||(()=>new Promise(e=>e())),t.injectCSS=!1!==t.injectCSS,this.options=t,this.sourceCanvas=e,this.domElement=t.domElement||x(t),this.__defaultDisplayStyle=this.domElement.style.display||"initial",this.manager=new b,this.manager.checkDisplays(),this.manager.addListener("change",e=>this.__onStateChange(e)),this.domElement.addEventListener("click",()=>this.__onEnterVRClick()),this.__forceDisabled=!1,this.setTitle(this.options.textEnterVRTitle)}setTitle(e){return this.domElement.title=e,S(this.domElement,this.options.cssprefix,"title",t=>{e?(t.innerText=e,t.style.display="initial"):t.style.display="none"}),this}setTooltip(e){return this.domElement.title=e,this}show(){return this.domElement.style.display=this.__defaultDisplayStyle,this.emit("show"),this}hide(){return this.domElement.style.display="none",this.emit("hide"),this}enable(){return this.__setDisabledAttribute(!1),this.__forceDisabled=!1,this}disable(){return this.__setDisabledAttribute(!0),this.__forceDisabled=!0,this}remove(){this.manager.remove(),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement)}getVRDisplay(){return b.getVRDisplay()}isPresenting(){return this.state===h||this.state==c}requestEnterVR(){return new Promise((e,t)=>{if(this.options.onRequestStateChange(h))return this.options.beforeEnter?this.options.beforeEnter().then(()=>this.manager.enterVR(this.manager.defaultDisplay,this.sourceCanvas)).then(e):this.manager.enterVR(this.manager.defaultDisplay,this.sourceCanvas).then(e);t(new Error(v))})}requestExit(){const e=this.state;return new Promise((t,n)=>{if(this.options.onRequestStateChange(l))return this.options.beforeExit().then(()=>e===h?this.manager.exitVR(this.manager.defaultDisplay):this.manager.exitFullscreen()).then(t);n(new Error(v))})}requestEnterFullscreen(){return new Promise((e,t)=>{if(this.options.onRequestStateChange(c))return this.options.beforeEnter?this.options.beforeEnter().then(()=>this.manager.enterFullscreen(this.sourceCanvas)).then(e):this.manager.enterFullscreen(this.sourceCanvas).then(e);t(new Error(v))})}__setDisabledAttribute(e){e||this.__forceDisabled?this.domElement.setAttribute("disabled","true"):this.domElement.removeAttribute("disabled")}__onEnterVRClick(){this.state==l?this.requestEnterVR():this.isPresenting()&&this.requestExit()}__onStateChange(e){if(e!=this.state)switch(this.state!==h&&this.state!==c||this.emit("exit",this.manager.defaultDisplay),this.state=e,e){case l:this.show(),this.setTitle(this.options.textEnterVRTitle),this.manager.defaultDisplay&&this.setTooltip("Enter VR using "+this.manager.defaultDisplay.displayName),this.__setDisabledAttribute(!1),this.emit("ready",this.manager.defaultDisplay);break;case h:case c:this.manager.defaultDisplay&&this.manager.defaultDisplay.capabilities.hasExternalDisplay&&e!=c||this.hide(),this.setTitle(this.options.textExitVRTitle),this.__setDisabledAttribute(!1),this.emit("enter",this.manager.defaultDisplay);break;case p:this.show(),this.setTitle(this.options.textVRNotFoundTitle),this.setTooltip("Browser not supported"),this.__setDisabledAttribute(!0),this.emit("error",new Error(e));break;case d:this.show(),this.setTitle(this.options.textVRNotFoundTitle),this.setTooltip("No VR headset found."),this.__setDisabledAttribute(!0),this.emit("error",new Error(e));break;case f:this.show(),this.setTitle(this.options.textVRNotFoundTitle),this.setTooltip("Something went wrong trying to start presenting to your headset."),this.__setDisabledAttribute(!0),this.emit("error",new Error(e));break;case m:default:this.show(),this.setTitle(this.options.textVRNotFoundTitle),this.setTooltip("Unknown error."),this.__setDisabledAttribute(!0),this.emit("error",new Error(e))}}}const S=(e,t,n,i)=>{const r=e.querySelector("."+t+"-"+n);r&&i(r)};"undefined"!=typeof AFRAME&&AFRAME&&AFRAME.registerComponent("webvr-ui",{dependencies:["canvas"],schema:{enabled:{type:"boolean",default:!0},color:{type:"string",default:"white"},background:{type:"string",default:"black"},corners:{type:"string",default:"square"},disabledOpacity:{type:"number",default:.5},textEnterVRTitle:{type:"string"},textExitVRTitle:{type:"string"},textVRNotFoundTitle:{type:"string"}},init:function(){},update:function(){let e=document.querySelector("a-scene");if(e.setAttribute("vr-mode-ui",{enabled:!this.data.enabled}),this.data.enabled){if(this.enterVREl)return;let t={color:this.data.color,background:this.data.background,corners:this.data.corners,disabledOpacity:this.data.disabledOpacity,textEnterVRTitle:this.data.textEnterVRTitle,textExitVRTitle:this.data.textExitVRTitle,textVRNotFoundTitle:this.data.textVRNotFoundTitle,onRequestStateChange:function(t){return t==h?e.enterVR():e.exitVR(),!1}},n=this.enterVR=new T(e.canvas,t);this.enterVREl=n.domElement,document.body.appendChild(n.domElement),n.domElement.style.position="absolute",n.domElement.style.bottom="10px",n.domElement.style.left="50%",n.domElement.style.transform="translate(-50%, -50%)",n.domElement.style.textAlign="center"}else this.enterVREl&&(this.enterVREl.parentNode.removeChild(this.enterVREl),this.enterVR.remove())},remove:function(){this.enterVREl&&(this.enterVREl.parentNode.removeChild(this.enterVREl),this.enterVR.remove())}});var V,F=((V=t.createElement("video")).crossOrigin="anonymous",V.hasAttribute("crossorigin")),D=(n.EventTarget,function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.buildCSSClass=function(){return"vjs-big-vr-play-button "+e.prototype.buildCSSClass.call(this)},t}(n.getComponent("BigPlayButton")));n.registerComponent("BigVrPlayButton",D);var P={debug:!1,omnitone:!1,forceCardboard:!1,omnitoneOptions:{},projection:"AUTO",sphereDetail:32,disableTogglePlay:!1},A={"web-vr-out-of-date":{headline:"360 is out of date",type:"360_OUT_OF_DATE",message:"Your browser supports 360 but not the latest version. See <a href='http://webvr.info'>http://webvr.info</a> for more info."},"web-vr-not-supported":{headline:"360 not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser does not support 360. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."},"web-vr-hls-cors-not-supported":{headline:"360 HLS video not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser/device does not support HLS 360 video. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."}},O=n.getPlugin("plugin"),k=n.getComponent("Component"),$=function(i){function r(t,r){var o,a=n.mergeOptions(P,r);return(o=i.call(this,t,a)||this).options_=a,o.player_=t,o.bigPlayButtonIndex_=t.children().indexOf(t.getChild("BigPlayButton"))||0,o.videojsErrorsSupport_=!!n.errors,o.videojsErrorsSupport_&&t.errors({errors:A}),n.browser.IE_VERSION||!F?(o.player_.on("loadstart",(function(){o.triggerError_({code:"web-vr-not-supported",dismiss:!1})})),s(o)):(o.animate_=n.bind(s(o),o.animate_),o.player_.on("touchstart",(function(){"function"==typeof DeviceMotionEvent.requestPermission&&DeviceMotionEvent.requestPermission().then((function(t){"granted"===t&&e.addEventListener("devicemotion",(function(){}))})).catch(console.error)})),o.on(t,"loadedmetadata",o.init),o)}a(r,i);var o=r.prototype;return o.triggerError_=function(e){if(this.videojsErrorsSupport_)this.player_.error(e);else{var n=t.createElement("div");n.innerHTML=A[e.code].message;var i=n.textContent||n.innerText||"";this.player_.error({code:e.code,message:i})}},o.requestAnimationFrame=function(e){return this.vrDisplay?this.vrDisplay.requestAnimationFrame(e):this.player_.requestAnimationFrame(e)},o.cancelAnimationFrame=function(e){return this.vrDisplay?this.vrDisplay.cancelAnimationFrame(e):this.player_.cancelAnimationFrame(e)},o.init=function(){this.reset(),this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({devicePixelRatio:e.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0}),this.renderer.setSize(this.player_.currentWidth(),this.player_.currentHeight()),this.camera=new THREE.PerspectiveCamera(75,this.player_.currentWidth()/this.player_.currentHeight(),1,1e3),this.camera.position.set(0,0,300),this.orbitController=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.orbitController.enableZoom=!1,this.orbitController.update(),this.vrController=new THREE.VRControls(this.camera),this.videoTexture=new THREE.VideoTexture(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=THREE.LinearFilter,this.videoTexture.magFilter=THREE.LinearFilter,this.videoTexture.format=THREE.RGBFormat,this.cameraVector=new THREE.Vector3,this.movieGeometry=new THREE.SphereBufferGeometry(500,60,40),this.movieGeometry.scale(-1,1,1),this.movieMaterial=new THREE.MeshBasicMaterial({map:this.videoTexture,side:THREE.DoubleSide}),this.movieScreen=new THREE.Mesh(this.movieGeometry,this.movieMaterial),this.movieScreen.rotation.y=Math.PI/2,this.scene.add(this.movieScreen),this.setupStage(),this.vrEffect=new THREE.VREffect(this.renderer),this.vrEffect.setSize(this.player_.currentWidth(),this.player_.currentHeight()),this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");var t=this.getVideoEl_().style;this.player_.el().insertBefore(this.renderedCanvas,this.player_.el().firstChild),t.zIndex="-1",t.opacity="0";var n=new T(this.renderer.domElement,{color:"black",background:"white",corners:"square"});this.player_.el().appendChild(n.domElement),this.initialized_=!0,this.trigger("initialized")},o.animate_=function(){this.initialized_&&(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.movieScreen.y+=4e-4,this.vrEffect.render(this.scene,this.camera),this.animationFrameId_=this.vrDisplay.requestAnimationFrame(this.animate_))},o.setupStage=function(){var e=this;navigator.getVRDisplays().then((function(t){t.length>0&&(e.vrDisplay=t[0],e.vrDisplay.stageParameters&&setStageDimensions(e.vrDisplay.stageParameters),e.vrDisplay.requestAnimationFrame(e.animate_))}))},o.setStageDimensions=function(e){var t=this.movieScreen.material;scene.remove(this.movieScreen);var n=new THREE.BoxGeometry(e.sizeX,boxSize,e.sizeZ);this.movieScreen=new THREE.Mesh(n,t),this.movieScreen.position.y=boxSize/2,scene.add(this.movieScreen)},o.getVideoEl_=function(){return this.player_.el().getElementsByTagName("video")[0]},o.reset=function(){if(this.initialized_){this.player_.getChild("BigPlayButton")||this.player_.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player_.getChild("BigVrPlayButton")&&this.player_.removeChild("BigVrPlayButton");var e=this.getVideoEl_().style;e.zIndex="",e.opacity="",this.currentProjection_=this.defaultProjection_,this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}},o.dispose=function(){i.prototype.dispose.call(this),this.reset()},r}(O);return $.prototype.setTimeout=k.prototype.setTimeout,$.prototype.clearTimeout=k.prototype.clearTimeout,$.VERSION="1.10.0",n.registerPlugin("vr",$),$}));
